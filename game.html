<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turbo Racer - Fixed</title>
    <style>
        body { margin: 0; background: #111; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; color: white; font-family: sans-serif; overflow: hidden; }
        canvas { border: 4px solid #333; background: #333; cursor: crosshair; }
        #overlay { position: absolute; text-align: center; pointer-events: none; width: 100%; top: 20px; z-index: 5; }
        #startScreen, #gameOver { position: absolute; background: rgba(0,0,0,0.9); padding: 40px; text-align: center; border-radius: 10px; border: 2px solid #00d4ff; z-index: 10; }
        button { background: #00d4ff; border: none; color: black; padding: 12px 25px; cursor: pointer; font-weight: bold; border-radius: 5px; font-size: 16px; margin-top: 15px; }
    </style>
</head>
<body>

    <div id="startScreen">
        <h1>TURBO RACER</h1>
        <p>Move mouse to steer. Collect blue orbs!</p>
        <button onclick="startGame()">START RACE</button>
    </div>

    <div id="gameOver" style="display:none;">
        <h1>WRECKED</h1>
        <p id="finalScore"></p>
        <button onclick="resetGame()">RETRY</button>
    </div>

    <div id="overlay">
        <h2 id="scoreDisplay">SCORE: 0</h2>
        <p id="shieldStatus" style="color: #00d4ff;"></p>
    </div>

    <canvas id="raceCanvas"></canvas>

<script>
    const canvas = document.getElementById('raceCanvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 400;
    canvas.height = 600;

    let score, gameSpeed, gameActive = false, frameCount;
    let player = { x: 175, y: 500, w: 50, h: 80, shield: 0 };
    let enemies = [], powerups = [], roadStrips = [];

    function resetGame() {
        score = 0; gameSpeed = 7; frameCount = 0;
        enemies = []; powerups = []; roadStrips = [];
        player.shield = 0; 
        
        // Create road markings that actually move down the screen
        for (let i = 0; i < 8; i++) {
            roadStrips.push({ x: 195, y: i * 100, w: 10, h: 50 });
        }
        
        document.getElementById('gameOver').style.display = 'none';
        document.getElementById('startScreen').style.display = 'none';
        gameActive = true;
        loop();
    }

    function startGame() { resetGame(); }

    window.addEventListener('mousemove', (e) => {
        if (!gameActive) return;
        let rect = canvas.getBoundingClientRect();
        player.x = Math.max(60, Math.min(e.clientX - rect.left - 25, 290));
    });

    function update() {
        if (!gameActive) return;
        score++;
        if (score % 500 === 0) gameSpeed += 0.5;
        if (player.shield > 0) player.shield--;

        // MOVE THE ROAD
        roadStrips.forEach(strip => {
            strip.y += gameSpeed;
            if (strip.y > canvas.height) strip.y = -100; // Reset to top
        });

        if (frameCount % 60 === 0) {
            const lanes = [75, 175, 275];
            let lane = lanes[Math.floor(Math.random() * lanes.length)];
            if (Math.random() > 0.9) powerups.push({ x: lane, y: -50 });
            else enemies.push({ x: lane - 25, y: -100, speed: gameSpeed + 1 });
        }

        powerups.forEach((p, i) => {
            p.y += gameSpeed;
            if (Math.hypot(player.x + 25 - p.x, player.y + 40 - p.y) < 40) {
                player.shield = 300;
                powerups.splice(i, 1);
            }
        });

        enemies.forEach((e, i) => {
            e.y += e.speed;
            if (player.x < e.x + 50 && player.x + 50 > e.x && player.y < e.y + 80 && player.y + 80 > e.y) {
                if (player.shield > 0) { enemies.splice(i, 1); score += 500; } 
                else { gameActive = false; }
            }
            if (e.y > canvas.height) enemies.splice(i, 1);
        });

        frameCount++;
        document.getElementById('scoreDisplay').innerText = `SCORE: ${score}`;
        document.getElementById('shieldStatus').innerText = player.shield > 0 ? "SHIELD ACTIVE" : "";
    }

    function draw() {
        // Draw Grass
        ctx.fillStyle = '#1e3d1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw Road
        ctx.fillStyle = '#333';
        ctx.fillRect(50, 0, 300, canvas.height);

        // DRAW MOVING ROAD STRIPS
        ctx.fillStyle = '#fff';
        roadStrips.forEach(strip => {
            ctx.fillRect(strip.x, strip.y, strip.w, strip.h);
        });

        // Draw Powerups
        powerups.forEach(p => {
            ctx.fillStyle = '#00d4ff';
            ctx.beginPath(); ctx.arc(p.x, p.y, 15, 0, Math.PI*2); ctx.fill();
        });

        // Draw Enemies (Red)
        enemies.forEach(e => {
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(e.x, e.y, 50, 80);
        });

        // Draw Player (Blue)
        ctx.fillStyle = '#00d4ff';
        if (player.shield > 0) {
            ctx.shadowBlur = 20; ctx.shadowColor = '#00d4ff';
        }
        ctx.fillRect(player.x, player.y, 50, 80);
        ctx.shadowBlur = 0;

        if (!gameActive) {
            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('finalScore').innerText = `Score: ${score}`;
            return;
        }
        requestAnimationFrame(draw);
    }

    function loop() { update(); draw(); }
</script>
</body>
</html>
